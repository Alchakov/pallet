"use strict";function _classCallCheck(n,a){if(!(n instanceof a))throw new TypeError("Cannot call a class as a function")}var $=jQuery.noConflict();!function(){var n=$(window),e=void 0,a=new function n(){var t=this;_classCallCheck(this,n),this.init=function(){var o=t;e=null,$("body").on("click",".run-form",function(n){n.preventDefault();var a=$(this).parents("form");$.getJSON("/wp-content/themes/pallet/inc/form/cfg/"+a.attr("name")+".json",function(n){o.validateForm(a,n)}).fail(function(){return!1})})},this.validateForm=function(n,a){var o=t;n.attr("name");if(n.validate({rules:a.rules,messages:a.messages,focusInvalid:!1,invalidHandler:function(){n.find(".form__result").html("<p>Заполните необходимые поля и повторите попытку</p>")}}),n.valid())return o.sendForm(n,a),!1},this.sendForm=function(o,n){null!==e&&e.abort();var a=o.attr("name"),t=o.data("action")||"run_form";o.find(".form-result").html(""),e=$.post({url:"/wp-admin/admin-ajax.php",data:"action="+t+"&subject="+n.subject+"&successMsg="+n.success+"&formName="+a+"&"+o.serialize(),cache:!1,beforeSend:function(){o.find(".form__result").html(""),o.block({message:null,overlayCSS:{backgroundColor:"#fff",opacity:.5}})}}).done(function(a){!0===a.success?($("body").append(a.data.modal),o[0].reset(),$(".modal").modal("hide"),setTimeout(function(){$("#thanks-modal-box").modal("show")},300),$("#thanks-modal-box").on("hidden.bs.modal",function(n){$(this).remove(),a.data.location&&(window.location.replace(a.data.location),window.location.reload())})):o.find(".form__result").html("<p>"+a.data+"</p>")}).fail(function(n,a,o){alert("Ошибка")}).always(function(n){o.unblock(),e=null})}};n.on("DOMContentLoaded",a.init())}();