# Структура файлов темы Pallet

Документация описывает структуру и назначение файлов WordPress темы Pallet.

## Корневые файлы

### Основные файлы темы
- **style.css** - Главный файл стилей темы, содержит стили для брендов, фильтров, отзывов, карточек и иконок Font Awesome
- **functions.php** - Главный файл функций темы, подключает все модули и зависимости
- **functions.original-php** - Оригинальная версия functions.php (резервная копия)
- **header.php** - Шапка сайта
- **footer.php** - Подвал сайта
- **sidebar.php** - Боковая панель
- **index.php** - Основной шаблон для вывода контента
- **404.php** - Страница ошибки 404
- **front-page.php** - Шаблон главной страницы
- **singular.php** - Шаблон для отдельных записей и страниц
- **singular-full.php** - Полноширинный шаблон для отдельных записей

### Служебные файлы
- **screenshot.png** - Скриншот темы для админ-панели WordPress
- **vg-sheet-editor-frontend.php** - Интеграция с плагином VG Sheet Editor

### JavaScript
- **custom-filter.js** - Скрипт для работы пользовательских фильтров

## Папка /inc

Содержит основную функциональность темы.

### Подпапки

#### /inc/classes
Классы для различных компонентов темы.

#### /inc/custom-fields
Настройки и регистрация пользовательских полей через Carbon Fields.

- **front-page.php** - Поля для главной страницы
- **front-page copy.php** - Копия настроек главной страницы
- **gutenberg.php** - Настройки Gutenberg блоков
- **post-meta.php** - Метаполя для постов (производители, отзывы, акции, сотрудники) с динамическими опциями таксономий
- **term-meta.php** - Метаполя для терминов таксономий
- **theme-options.php** - Глобальные настройки темы
- **variables.php** - Переменные для использования в полях

#### /inc/form
Формы и обработчики форм.

#### /inc/post_type
Регистрация пользовательских типов постов.

- **PLT_Brand.php** - Тип поста "Производители" с таксономиями (категории, регионы, фильтры, связь с продуктами)
- **PLT_Client.php** - Тип поста "Клиенты"
- **PLT_Discount.php** - Тип поста "Акции"
- **PLT_Office.php** - Тип поста "Офисы" с полями для адреса и контактов
- **PLT_Review.php** - Тип поста "Отзывы" с привязкой к брендам и рейтингом
- **PLT_Video.php** - Тип поста "Видео"
- **PLT_Worker.php** - Тип поста "Сотрудники"

### Корневые файлы /inc

- **brand-filters-admin.php** - Управление фильтрами брендов в админке
- **custom_fields.php** - Инициализация и регистрация пользовательских полей
- **customizer.php** - Настройки кастомайзера WordPress
- **rating-functions.php** - Функции для работы с рейтингами и отзывами
- **shortcodes.php** - Регистрация шорткодов

## Папка /js

JavaScript файлы темы.

## Папка /parts

Шаблонные части (template parts).

- **loop-brand.php** - Шаблон для вывода карточки бренда в архиве с рейтингом и фильтрами

## Папка /templates

Страничные шаблоны.

- **archive-brand.php** - Шаблон архива производителей с фильтрацией
- **single-brand.php** - Шаблон отдельной страницы производителя с рейтингом, фильтрами и отзывами

## Папка /assets

Статические ресурсы (изображения, шрифты, стили SCSS).

## Документация

- **BRANDS_IMPLEMENTATION.md** - Документация по реализации системы брендов
- **BRAND_FILTERS_IMPLEMENTATION.md** - Руководство по реализации фильтров для брендов
- **REGION_CITY_MAP_IMPLEMENTATION.md** - Документация по реализации карты регионов и городов
- **FILES_STRUCTURE.md** - Текущий файл с описанием структуры

## Архитектура

### Система брендов
Включает:
- Пользовательский тип поста `brand`
- Таксономии: категории, регионы, фильтры
- Метаполя через Carbon Fields для контактов, карты, рейтинга, галереи
- Привязка отзывов к брендам
- Расчёт среднего рейтинга на основе отзывов
- Отображение фильтров и регионов в карточках брендов

### Система рейтингов
- Отзывы привязываются к брендам через association поле
- Автоматический расчёт среднего рейтинга
- Выбор источника рейтинга: отзывы или виджет Яндекс
- Отображение звёзд в архиве и на странице бренда

### Фильтры брендов
- Динамическая таксономия `brand_feature`
- Возможность создавать/редактировать фильтры через админку
- Привязка фильтров к брендам через multiselect поле
- Отображение в карточках и на страницах брендов

### Регионы
- Иерархическая таксономия `region`
- Привязка брендов к регионам через select поле
- Интеграция с картами через координаты

## Зависимости

- **Carbon Fields** - Для создания пользовательских полей
- **Font Awesome 6.5.1** - Иконки (подключено через CDN)
- **WordPress 5.0+** - Минимальная версия WordPress

## Примечания

1. Все динамические опции для полей загружаются через helper-функцию `plt_get_taxonomy_options()`
2. Перед использованием полей регионов и фильтров необходимо создать термины в соответствующих таксономиях
3. Тема использует современную структуру с разделением логики по модулям
4. Файлы стилей SCSS компилируются в CSS
